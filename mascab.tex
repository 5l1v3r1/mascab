\documentclass[a4paper,10pt]{article}

\usepackage{adjustbox}
\usepackage{hyperref}
\usepackage[backend=biber,style=draft,hyperref=true,defernumbers=true]{biblatex}
\usepackage{listings}
\usepackage[margin=2cm]{geometry}
\usepackage[usenames,dvipsnames,svgnames,table]{xcolor}

\addbibresource{mascab.bib}
\addbibresource{mascab-peripheral.bib}
\addbibresource{mascab-scratchpad.bib}

\DeclareSourcemap{
  \maps[datatype=bibtex]{
    \map{\step[fieldset=keywords,fieldvalue={unclassified}]}
  }
}

\DeclareFieldFormat{addendum}{\newline\adjustbox{minipage=[H]{\linewidth},frame={1pt 1ex 0ex}}{\color{darkgray} #1}} 
\renewcommand*\finentrypunct{}
\defbibheading{subsubbibnumbered}[\bibname]{\subsubsection{#1}\markboth{#1}{#1}}

\begin{document}

\begin{center}
{\LARGE\scshape {MASCAB}: a Micro-Architectural Side-Channel Attack Bibliography \par} \vspace{0.5cm}
{\LARGE         \url{http://www.github.com/danpage/mascab}                       \par} \vspace{1.0cm}
{\Large\scshape D. Page                                                          \par}
{\Large\scshape \today                                                           \par} \vspace{1.0cm}
\end{center}

\tableofcontents \nocite{*} \newpage

% =============================================================================

\section{Miscellaneous}

\printbibliography[ heading={subbibnumbered},                keyword={class=misc/history},      title={History                                                                                } ]
\printbibliography[ heading={subbibnumbered},                keyword={class=misc/datasheet},    title={Datasheet                                                                              } ]
\printbibliography[ heading={subbibnumbered},                keyword={class=misc/patent},       title={Patent                                                                                 } ]
\printbibliography[ heading={subbibnumbered},                keyword={class=misc/standard},     title={Standard                                                                               } ]
\printbibliography[ heading={subbibnumbered},                keyword={class=misc/survey},       title={Survey                                                                                 } ]
\printbibliography[ heading={subbibnumbered},                keyword={class=misc/position},     title={Position                                                                               } ]
\printbibliography[ heading={subbibnumbered},                keyword={class=misc/book},         title={Book                                                                                   } ]
\printbibliography[ heading={subbibnumbered},                keyword={class=misc/thesis},       title={Thesis                                                                                 } ]
\printbibliography[ heading={subbibnumbered},                keyword={class=misc/software},     title={Software                                                                               } ]

% =============================================================================

\section{Covert channels}

\defbibfilter{f}{keyword={class=channel/covert}}

\printbibliography[ heading={subbibnumbered},    filter={f}, keyword={topic=neg},               title={Negative    use-cases                                                                  } ]

\printbibliography[ heading={subbibnumbered},    filter={f}, keyword={topic=pos/hardware},      title={Positive    use-cases: hardware-based countermeasures                                  } ]
\printbibliography[ heading={subbibnumbered},    filter={f}, keyword={topic=pos/software},      title={Positive    use-cases: software-based countermeasures                                  } ]

\printbibliography[ heading={subbibnumbered},    filter={f}, keyword={topic=alt}                title={Alternative use-cases                                                                  } ]

% =============================================================================

\section{Side-channels}

% -----------------------------------------------------------------------------

\subsection{Caches (data {\em and} instruction)}

\defbibfilter{f}{keyword={class=channel/side/cache} and keyword={style=dcache/access}}

\printbibliography[ heading={subsubbibnumbered}, filter={f}, keyword={topic=neg/method},        title={Negative    use-cases: attacks using        data-cache (access-based,      methodology)} ]
\printbibliography[ heading={subsubbibnumbered}, filter={f}, keyword={topic=neg/attack/crypto}, title={Negative    use-cases: attacks using        data-cache (access-based, vs. cryptography)} ]
\printbibliography[ heading={subsubbibnumbered}, filter={f}, keyword={topic=neg/attack/ui},     title={Negative    use-cases: attacks using        data-cache (access-based, vs.           UI)} ]
\printbibliography[ heading={subsubbibnumbered}, filter={f}, keyword={topic=neg/attack/iee},    title={Negative    use-cases: attacks using        data-cache (access-based, vs.          IEE)} ]
\printbibliography[ heading={subsubbibnumbered}, filter={f}, keyword={topic=neg/attack/aslr},   title={Negative    use-cases: attacks using        data-cache (access-based, vs.         ASLR)} ]

\defbibfilter{f}{keyword={class=channel/side/cache} and keyword={topic=neg}}

\printbibliography[ heading={subsubbibnumbered}, filter={f}, keyword={style=dcache/time},       title={Negative    use-cases: attacks using        data-cache,  (time-based)                  } ]
\printbibliography[ heading={subsubbibnumbered}, filter={f}, keyword={style=dcache/trace},      title={Negative    use-cases: attacks using        data-cache, (trace-based)                  } ]
\printbibliography[ heading={subsubbibnumbered}, filter={f}, keyword={style=dcache/power},      title={Negative    use-cases: attacks using        data-cache, (power-based)                  } ]
\printbibliography[ heading={subsubbibnumbered}, filter={f}, keyword={style=icache},            title={Negative    use-cases: attacks using instruction-cache                                 } ]
\printbibliography[ heading={subsubbibnumbered}, filter={f}, keyword={style=icache},            title={Negative    use-cases: attacks using             cache pre-fetch                       } ]

\defbibfilter{f}{keyword={class=channel/side/cache}}

\printbibliography[ heading={subsubbibnumbered}, filter={f}, keyword={topic=pos/hardware},      title={Positive    use-cases: hardware-based countermeasures                                  } ]
\printbibliography[ heading={subsubbibnumbered}, filter={f}, keyword={topic=pos/software},      title={Positive    use-cases: software-based countermeasures                                  } ]
\printbibliography[ heading={subsubbibnumbered}, filter={f}, keyword={topic=pos/analysis},      title={Positive    use-cases: analysis-based countermeasures (e.g., of source code)           } ]

\defbibfilter{f}{keyword={class=channel/side/cache} and keyword={topic=alt}}

\printbibliography[ heading={subsubbibnumbered}, filter={f},                                    title={Alternative use-cases                                                                  } ]

\printbibliography[ heading={subsubbibnumbered}, filter={f}, keyword={topic=analysis/attack},   title={Analysis (of attacks)                                                                  } ]
\printbibliography[ heading={subsubbibnumbered}, filter={f}, keyword={topic=analysis/hw},       title={Analysis (of hardware)                                                                 } ]

\printbibliography[ heading={subsubbibnumbered}, filter={f}, keyword={topic=misc},              title={Miscellaneous                                                                          } ]

% -----------------------------------------------------------------------------

\subsection{Branch prediction}

\defbibfilter{f}{keyword={class=channel/side/branch}}

\printbibliography[ heading={subsubbibnumbered}, filter={f}, keyword={topic=neg},               title={Negative use-cases: attacks                                                            } ]

\printbibliography[ heading={subsubbibnumbered}, filter={f}, keyword={topic=pos/hardware},      title={Positive use-cases: hardware-based countermeasures                                     } ]
\printbibliography[ heading={subsubbibnumbered}, filter={f}, keyword={topic=pos/software},      title={Positive use-cases: software-based countermeasures                                     } ]
\printbibliography[ heading={subsubbibnumbered}, filter={f}, keyword={topic=pos/analysis},      title={Positive use-cases: analysis-based countermeasures (e.g., of source code)              } ]

\printbibliography[ heading={subsubbibnumbered}, filter={f}, keyword={topic=alt}                title={Alternative use-cases                                                                  } ]

\printbibliography[ heading={subsubbibnumbered}, filter={f}, keyword={topic=analysis/attack},   title={Analysis (of attacks)                                                                  } ]
\printbibliography[ heading={subsubbibnumbered}, filter={f}, keyword={topic=analysis/hw},       title={Analysis (of hardware)                                                                 } ]

\printbibliography[ heading={subsubbibnumbered}, filter={f}, keyword={topic=misc},              title={Miscellaneous                                                                          } ]

% -----------------------------------------------------------------------------

\subsection{Speculative and/or out-of-order execution}

\defbibfilter{f}{keyword={class=channel/side/spec}}

\printbibliography[ heading={subsubbibnumbered}, filter={f}, keyword={topic=neg},               title={Negative use-cases: attacks                                                            } ]

\printbibliography[ heading={subsubbibnumbered}, filter={f}, keyword={topic=pos/hardware},      title={Positive use-cases: hardware-based countermeasures                                     } ]
\printbibliography[ heading={subsubbibnumbered}, filter={f}, keyword={topic=pos/software},      title={Positive use-cases: software-based countermeasures                                     } ]
\printbibliography[ heading={subsubbibnumbered}, filter={f}, keyword={topic=pos/analysis},      title={Positive use-cases: analysis-based countermeasures (e.g., of source code)              } ]

\printbibliography[ heading={subsubbibnumbered}, filter={f}, keyword={topic=alt}                title={Alternative use-cases                                                                  } ]

\printbibliography[ heading={subsubbibnumbered}, filter={f}, keyword={topic=analysis/attack},   title={Analysis (of attacks)                                                                  } ]
\printbibliography[ heading={subsubbibnumbered}, filter={f}, keyword={topic=analysis/hw},       title={Analysis (of hardware)                                                                 } ]

\printbibliography[ heading={subsubbibnumbered}, filter={f}, keyword={topic=misc},              title={Miscellaneous                                                                          } ]

% -----------------------------------------------------------------------------

\subsection{Arithmetic}

\defbibfilter{f}{keyword={class=channel/side/arith}}

\printbibliography[ heading={subsubbibnumbered}, filter={f}, keyword={topic=neg},               title={Negative use-cases: attacks                                                            } ]

\printbibliography[ heading={subsubbibnumbered}, filter={f}, keyword={topic=pos/hardware},      title={Positive use-cases: hardware-based countermeasures                                     } ]
\printbibliography[ heading={subsubbibnumbered}, filter={f}, keyword={topic=pos/software},      title={Positive use-cases: software-based countermeasures                                     } ]
\printbibliography[ heading={subsubbibnumbered}, filter={f}, keyword={topic=pos/analysis},      title={Positive use-cases: analysis-based countermeasures (e.g., of source code)              } ]

\printbibliography[ heading={subsubbibnumbered}, filter={f}, keyword={topic=alt}                title={Alternative use-cases                                                                  } ]

\printbibliography[ heading={subsubbibnumbered}, filter={f}, keyword={topic=misc},              title={Miscellaneous                                                                          } ]

% -----------------------------------------------------------------------------

\subsection{Network-on-Chip (NoC)}

\defbibfilter{f}{keyword={class=channel/side/noc}}

\printbibliography[ heading={subsubbibnumbered}, filter={f}, keyword={topic=neg},               title={Negative use-cases: attacks                                                            } ]

\printbibliography[ heading={subsubbibnumbered}, filter={f}, keyword={topic=pos/hardware},      title={Positive use-cases: hardware-based countermeasures                                     } ]
\printbibliography[ heading={subsubbibnumbered}, filter={f}, keyword={topic=pos/software},      title={Positive use-cases: software-based countermeasures                                     } ]
\printbibliography[ heading={subsubbibnumbered}, filter={f}, keyword={topic=pos/analysis},      title={Positive use-cases: analysis-based countermeasures (e.g., of source code)              } ]

\printbibliography[ heading={subsubbibnumbered}, filter={f}, keyword={topic=alt}                title={Alternative use-cases                                                                  } ]

\printbibliography[ heading={subsubbibnumbered}, filter={f}, keyword={topic=misc},              title={Miscellaneous                                                                          } ]

% -----------------------------------------------------------------------------

\subsection{Miscellaneous}

\defbibfilter{f}{keyword={class=channel/side/misc}}

\printbibliography[ heading={subsubbibnumbered}, filter={f}, keyword={topic=neg},               title={Negative use-cases: attacks                                                            } ]

\printbibliography[ heading={subsubbibnumbered}, filter={f}, keyword={topic=pos/hardware},      title={Positive use-cases: hardware-based countermeasures                                     } ]
\printbibliography[ heading={subsubbibnumbered}, filter={f}, keyword={topic=pos/software},      title={Positive use-cases: software-based countermeasures                                     } ]
\printbibliography[ heading={subsubbibnumbered}, filter={f}, keyword={topic=pos/analysis},      title={Positive use-cases: analysis-based countermeasures (e.g., of source code)              } ]

\printbibliography[ heading={subsubbibnumbered}, filter={f}, keyword={topic=alt}                title={Alternative use-cases                                                                  } ]

\printbibliography[ heading={subsubbibnumbered}, filter={f}, keyword={topic=misc},              title={Miscellaneous                                                                          } ]

% =============================================================================

\section{Cross-cutting topics}

\subsection{Performance counters}

\defbibfilter{f}{keyword={class=crosscut/perfctr}}

\printbibliography[ heading={subsubbibnumbered}, filter={f}, keyword={topic=neg},               title={Negative use-cases: attacks                                                            } ]
\printbibliography[ heading={subsubbibnumbered}, filter={f}, keyword={topic=pos},               title={Positive use-cases: countermeasures                                                    } ]

\subsection{IDS-like monitoring and detection}

\defbibfilter{f}{keyword={class=crosscut/ids}}

\printbibliography[ heading={none},              filter={f}                                                                                                                                     ]

% =============================================================================

\section{Peripheral topics}

\defbibfilter{f}{keyword={class=peripheral}}

\printbibliography[ heading={subbibnumbered},    filter={f}, keyword={topic=cache/security},    title={Caches: designs with general security properties                                       } ]
\printbibliography[ heading={subbibnumbered},    filter={f}, keyword={topic=cache/power},       title={Caches: designs for low-power                                                          } ]
\printbibliography[ heading={subbibnumbered},    filter={f}, keyword={topic=cache/partition},   title={Caches: designs that harness partitioning                                              } ]

\printbibliography[ heading={subbibnumbered},    filter={f}, keyword={topic=attack/rowhammer},  title={Attacks: results relating to RowHammer                                                 } ]
\printbibliography[ heading={subbibnumbered},    filter={f}, keyword={topic=attack/aslr},       title={Attacks: results relating to Address Space Layout Randomisation (ASLR)                 } ]
\printbibliography[ heading={subbibnumbered},    filter={f}, keyword={topic=attack/debug},      title={Attacks: results relating to test and debug mechanisms (e.g., scan-chain)              } ]
\printbibliography[ heading={subbibnumbered},    filter={f}, keyword={topic=attack/degrade},    title={Attacks: use of performance degradation                                                } ]
\printbibliography[ heading={subbibnumbered},    filter={f}, keyword={topic=attack/recover},    title={Attacks: techniques for key recovery                                                   } ]
\printbibliography[ heading={subbibnumbered},    filter={f}, keyword={topic=attack/paradigm},   title={Attacks: alterative paradigms                                                          } ]

\printbibliography[ heading={subbibnumbered},    filter={f}, keyword={topic=verify},            title={Verification                                                                           } ]

\printbibliography[ heading={subbibnumbered},    filter={f}, keyword={topic=misc},              title={Miscellaneous                                                                          } ]

% =============================================================================

\printbibliography[heading={bibnumbered},                    keyword={unclassified},            title={Residual unclassified entries                                                          } ]

%% =============================================================================

\end{document}
